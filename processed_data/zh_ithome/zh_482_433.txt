TensorFlow 里 模拟 宇宙 提升 模拟 计算 速度 成本 降低 1000 倍 去年 6月 俄罗斯 天文学家 兼码 农小哥 开发 款 名叫 Space   Engine 宇宙 模拟 游戏 目前 游戏 已经 收到 2639 份 测评 绝大部分 都 好评 Space   Engine 还 游戏 层面 宇宙 种 呈现 试想 以下 数值 模拟 基础 工具 观测 海量 宇宙 数据 进行 分析 …… 停 看到 大概 猜到 模拟 计算 肯定 代价 不菲 通常 需要 大 规模 超级 计算机 上 离线 运行 提升 模拟 计算 速度 机器 学习 组件 整合 统一 框架 内 会 不同 便 新 N体 宇宙 模拟 代码 FlowPM 做 没 错 文摘菌 今天 大家 展示 使用 TensorFlow 模拟 小 宇宙 说明 宇宙学 有着 激动人心 前景 展望 搓搓 小手 跟进 ~ 图 1 （ 蓝色 ） 2dFGRS 测量 宇宙 结构 （ 红色 ） 使用 N体 模拟 生成 千禧年 宇宙 结构 简单 来说 N体 模拟 方法 解释 宇宙 演化 中 非线性 演化 问题 科学家 提出 套 研究 宇宙学 数值 模拟 方法 宇宙学 领域 N体 模拟 还 原 宇宙 诞生 初 大 爆炸 演变 今 物质 初始 分布 大量 粒子 放置 一个 盒子 中 引力 牵引 粒子 会 不断 移动 最终 粒子 状态 浩瀚 宇宙 结构 再现 分布 中 看到 星系 星系群 分布 结构 形成 演化 取决于 一些 宇宙 相关 基础 问题 诸如 宇宙 中 物质 宇宙 膨胀 快 导致 宇宙 膨胀 黑物质 暗能量 特性 现代 宇宙学 研究 强大 望远镜 覆盖 辽阔 观测 区域 绘制 出 结构 时间 追溯 几十亿 年 前 N体 模拟 预测 观测 数据 进行 比较 帮助 解答 前述 基础 问题 提高 宇宙 诞生 演化 理解 几十 年 研究 更迭 N体 模拟 已 宇宙学界 主要 研究 工具 得益于 机器 学习 统计 推理 领域 最新 进展 一个 完全 基于 TensorFlow 实现 N体 宇宙 模拟 程序 FlowPM 应运而生 使用 Google   Colab   notebook 进行 实验 以下 主要 提供 TF1 编写 代码 需要 设置 好 边长 网格 大小 执行 代码 片段 模拟 参数 随后 执行 模拟 代码 片段 非常 简单 完整 代码 如下 示 生 成 下 图 示 大型 结构 图 2   （ 左 ） N体 模拟 启动 时 宇宙 中 物质 初始 分布 （ 右 ） 模拟 最终 快照 物质 最终 分布 清楚 看到 大型 结构 具有 晕圈 长丝 空洞 塌陷 或许 不少 人 会 疑惑 TensorFlow 真 香 文摘菌 把话 撂 还 真 香 TensorFlow 优势 主要 体现 以下 两 方面 分析 推理 TensorFlow 模拟 宇宙学家 提供 前所未有 独特 功能 说 可微性 （ differentiability ） 功能 科学家 提供 种 新 分析 工具 开发 基于 模拟 有效 推理 技术 不仅如此 功能 还 支持 量化 各类 输入 参数 调整 最终 观察 影响 伯克利 宇宙 中心 研究者 时光 倒流 重构 初始 状态 十分 感 兴趣 有助于 更 好 了解 现在 宇宙 结构 前提 必须 先 解决 一个 百万 维度 高度 非线性 优化 问题 模拟 过程 可微 FlowPM 做到 重构 后 图 如下 示 ▲   最终 黑物质 大型 宇宙 结构 （ 右边 ） 重建 宇宙 初始 状态 （ 左边 ） 一个 混合 物理 / 深度 学习 模拟 N体 模拟 运用 深度 学习 组件 时 会 需要 开发 一个 混合 前 模型 利用 当前 计算 资源 不 可能 高度 准确 模拟 所有 组件 只能 依据 科研 目标 不同 元素 之间 进行 取舍 宇宙 观察 深度 星系 范围 形成 星系 多维 物理 过程 现在 深度 学习 替代 模型 元素 自然 整合 进 N体 模拟 中 BCCP 科学家 开发 一个 混合 模拟 如下 图 示 模拟 宇宙 中 气体 动量 密度 目前 类 观察 采用 混合 模拟 实现 代价 非常 大 使用 一个 端 端 FlowPM 模型 成本 至少 降低 1000 倍 ▲   一个 混合 模拟 示例 两 层 非线性 变换 （ 网络 ） 补充 PM 模拟 暗物质 输出 （ 左 ） 模拟 宇宙 （ 中心 ） 气体 动量 密度 使用 昂贵 1000 倍 混合 模拟 模拟 真相 进行 比较 （ 右 ） 原理 看上去 很 简单 实际 挑战 很 大 毕竟 宇宙 真 很 庞大 准确 匹配 当前 未来 观测 模拟 数以亿计 粒子 变化 实现 N体 宇宙 模拟 主要 以下 两 难点 Mesh   TensorFlow 框架 轻松 使用 分布式 张量 表示 模拟 持续 追踪 分布式 梯度 设备 之间 存储 通信 Mesh   TensorFlow 编写 N体 求解 程序 巨大 仿真量 跨 超级 计算机 进行 分布 这种 模拟 中 步 操作 网格 组件 一个 时间 步长 演化 出 不同 空间 区域 云端 TPU 部署 相同 模拟 代码 模拟 128 128 x128x128 网格 独立 宇宙 部署 国家 计算机 （ NERSC ） 64 GPU 上 模拟 一个 1024 x 1024 x 1024 宇宙 支持 大 规模 仿真 模型 并行 框架 允许 计算 任务 分配 处理器 加速 中间 尺寸 模拟 如下 图 示 FlowPM 平均 模拟 速度 当前 可微 python 模拟器 FastPM 快 40 倍 不 止 ▲   使用 FastPM （ Cori   Haswell 内核 上 运行 基于 CPU python 代码 ） FlowPM （ Cori   GPU 上 运行 基于 GPU Mesh   TensorFlow 代码 ） 模拟 2563 网格 PM 比较 1 步长 内 时间 缩放 处理器 数量 过去 三十 年 数值 模拟 大型 宇宙 研究 基石 现在 FlowPM 研究 即将 迈出 新 步 模拟器 集成 包含 深度 学习 组件 统一 框架 内 保持 潜在 现象 准确 物理 理解 宇宙学 中 这种 结合 促生 新颖 分析 工具 研究 体系 中 加入 深度 模型 攻克 棘手 历史 难题 活跃 研究 领域 加速 催生 下 一代 宇宙 研究 未来 十 年 之间 观察 宇宙 中 成千上万 个体 多亏 Mesh   TensorFlow 模型 并行 框架 物理 建模 机器 学习 融合 得以 实现 希望 成分 分析 FlowPM 计算 工具 发展 宇宙学 以外 领域 得以 受益